(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-323d1ff7"],{"1d3d":function(t,e,a){"use strict";a.r(e);a("b0c0"),a("ac1f"),a("841c");var n=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",[e("el-card",{staticClass:"pad-card",attrs:{shadow:"never"}},[e("template",{slot:"header"},[e("el-form",{ref:"form",attrs:{model:t.form,inline:"","label-width":"40px"}},[e("el-form-item",{attrs:{label:"学期"}},[e("el-select",{attrs:{placeholder:"学期",size:"mini"},on:{change:t.xqChange},model:{value:t.form.xqid,callback:function(e){t.$set(t.form,"xqid",e)},expression:"form.xqid"}},t._l(t.xqList,(function(t,a){return e("el-option",{key:a,attrs:{label:t.name,value:t.value}})})),1)],1),e("el-form-item",{attrs:{label:"年级"}},[e("el-select",{attrs:{placeholder:"年级",size:"mini"},on:{change:t.njChange},model:{value:t.form.njid,callback:function(e){t.$set(t.form,"njid",e)},expression:"form.njid"}},t._l(t.njList,(function(t,a){return e("el-option",{key:a,attrs:{label:t.name,value:t.value}})})),1)],1),e("el-form-item",{attrs:{label:"班级"}},[e("el-select",{attrs:{placeholder:"班级",size:"mini"},model:{value:t.form.bjid,callback:function(e){t.$set(t.form,"bjid",e)},expression:"form.bjid"}},t._l(t.bjList,(function(t,a){return e("el-option",{key:a,attrs:{label:t.name,value:t.value}})})),1)],1),e("el-form-item",{attrs:{label:"姓名"}},[e("el-input",{attrs:{size:"mini",placeholder:"姓名"},on:{input:t.xmInput},model:{value:t.xm,callback:function(e){t.xm=e},expression:"xm"}})],1),e("el-form-item",[e("el-button-group",[e("el-button",{attrs:{size:"mini",icon:"el-icon-refresh",type:"info"},on:{click:t.reset}},[t._v(" 重置 ")]),e("el-button",{attrs:{size:"mini",icon:"el-icon-search",type:"primary"},on:{click:t.search}},[t._v(" 查询 ")])],1)],1),e("el-form-item",[e("el-dropdown",{attrs:{trigger:"click",placement:"bottom-start"}},[e("el-button",{attrs:{size:"mini",type:"warning",icon:"el-icon-download"}},[t._v(" "+t._s(t.selection.length>0?"下载选中的成绩汇报单(".concat(t.selection.length,")"):"下载本班所有成绩汇报单")+" ")]),e("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[e("el-dropdown-item",{nativeOn:{click:function(e){return t.downAllDoc("0")}}},[t._v(" PDF ")]),e("el-dropdown-item",{nativeOn:{click:function(e){return t.downAllDoc("1")}}},[t._v(" ZIP ")])],1)],1),e("el-checkbox",{directives:[{name:"show",rawName:"v-show",value:!t.needGaosan,expression:"!needGaosan"}],staticStyle:{"margin-left":"8px"},model:{value:t.needRank,callback:function(e){t.needRank=e},expression:"needRank"}},[t._v(" 含名次 ")]),e("el-checkbox",{directives:[{name:"show",rawName:"v-show",value:!t.needGaosan,expression:"!needGaosan"}],staticStyle:{"margin-left":"8px"},model:{value:t.needGrade,callback:function(e){t.needGrade=e},expression:"needGrade"}},[t._v(" 显示等第 ")])],1)],1)],1),e("el-table",{staticClass:"ss-table",attrs:{data:t.tableData,size:"mini"},on:{select:t.tableSelect,"select-all":t.tableSelect}},[e("el-table-column",{attrs:{type:"selection"}}),e("el-table-column",{attrs:{label:"学号",prop:"classnum"}}),e("el-table-column",{attrs:{label:"班级",prop:"classname"}}),e("el-table-column",{attrs:{label:"姓名",prop:"xm"}}),e("el-table-column",{attrs:{label:"操作",width:"120px"},scopedSlots:t._u([{key:"default",fn:function(a){var n=a.row;return[e("el-link",{attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.downDoc(n)}}},[t._v(" 下载 ")]),e("el-link",{attrs:{size:"mini",type:"success"},on:{click:function(e){return t.preview(n)}}},[t._v(" 预览 ")])]}}])})],1)],2),e("student-doc-preview",{attrs:{visible:t.visible,"need-rank":t.needRank,"need-grade":t.needGrade,"student-info":t.studentInfo},on:{"update:visible":function(e){t.visible=e},close:function(e){t.visible=!1}}})],1)},s=[],i=a("d4ec"),d=a("bee2"),o=a("262e"),c=a("2caf"),l=(a("4de4"),a("d3b7"),a("159b"),a("14d9"),a("9ab4")),r=a("60a3"),u=a("73ec"),m=(a("99af"),function(){var t=this,e=t._self._c;t._self._setupProxy;return e("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{visible:t.visible,top:"30px"},on:{open:t.open,close:t.close}},[e("div",{staticClass:"doc-body"},[t.needGaosan?e("table",{staticClass:"document-table"},[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"center"},attrs:{colspan:9}},[e("div",[t._v("上海市实验学校学生成绩汇报单")]),e("div",[t._v(t._s("".concat(t.studentDoc.termname||"---")))]),e("div",[t._v(t._s("".concat(t.studentDoc.classname||"---"," - ").concat(t.studentDoc.xm||"---")))])])])]),e("tbody",[t._l(t.studentDoc.subjectinfo,(function(a,n){return["高考课程"==a.kmmc?[e("tr",{key:"".concat(n,"1tr")},[e("td",{attrs:{colspan:9}},[t._v(t._s(t.studentDoc.subjectinfo[0].kmmc))])]),e("tr",{key:"".concat(n,"2tr")},[4==t.tableHeaderData.length?[e("td",[t._v("科目")]),t._l(t.tableHeaderData,(function(a,n){return[e("td",{key:"".concat(n,"1tr")},[t._v(t._s(a.ksmc))]),e("td",{key:"".concat(n,"2tr")},[t._v("年级名次")])]}))]:[e("td",[t._v("科目")]),e("td",[t._v(t._s(t.tableHeaderData[0]?t.tableHeaderData[0].ksmc:"第一次月考"))]),e("td",[t._v("年级名次")]),e("td",[t._v(t._s(t.tableHeaderData[1]?t.tableHeaderData[1].ksmc:"第二次月考"))]),e("td",[t._v("年级名次")]),e("td",[t._v(t._s(t.tableHeaderData[2]?t.tableHeaderData[2].ksmc:"第三次月考"))]),e("td",[t._v("年级名次")]),e("td",[t._v(t._s(t.tableHeaderData[3]?t.tableHeaderData[3].ksmc:"第四次月考"))]),e("td",[t._v("年级名次")])]],2)]:[e("tr",{directives:[{name:"show",rawName:"v-show",value:t.hasData(a),expression:"hasData(item)"}],key:"".concat(n,"tr")},[4==t.tableHeaderData.length?[e("td",[t._v(t._s(a.kmmc))]),t._l(t.tableHeaderData,(function(n,s){return[e("td",{key:"".concat(s,"1tr")},[t._v(t._s(a[t.tableHeaderData[s].ksmc]))]),e("td",{key:"".concat(s,"2tr")},[t._v(t._s(a[t.tableHeaderData[s].ksmc+"年级名次"]))])]}))]:[e("td",[t._v(t._s(a.kmmc))]),e("td",[t._v(t._s(t.tableHeaderData[0]?a[t.tableHeaderData[0].ksmc]:""))]),e("td",[t._v(t._s(t.tableHeaderData[0]?a[t.tableHeaderData[0].ksmc+"年级名次"]:""))]),e("td",[t._v(t._s(t.tableHeaderData[1]?a[t.tableHeaderData[1].ksmc]:""))]),e("td",[t._v(t._s(t.tableHeaderData[1]?a[t.tableHeaderData[1].ksmc+"年级名次"]:""))]),e("td",[t._v(t._s(t.tableHeaderData[2]?a[t.tableHeaderData[2].ksmc]:""))]),e("td",[t._v(t._s(t.tableHeaderData[2]?a[t.tableHeaderData[2].ksmc+"年级名次"]:""))]),e("td",[t._v(t._s(t.tableHeaderData[3]?a[t.tableHeaderData[3].ksmc]:""))]),e("td",[t._v(t._s(t.tableHeaderData[3]?a[t.tableHeaderData[3].ksmc+"年级名次"]:""))])]],2)]]})),e("tr",[e("td",{attrs:{colspan:9}},[t._v("其他课程")])]),e("tr",[e("td",{attrs:{colspan:3}},[t._v("科目")]),e("td",[t._v("平时成绩")]),e("td",[t._v("期中成绩")]),e("td",[t._v("年级平均")]),e("td",[t._v("期末成绩")]),e("td",[t._v("年级平均")]),e("td",[t._v("学期总评")])]),t._l(t.studentDoc.othersubjectinfo,(function(a,n){return e("tr",{key:n},[e("td",{attrs:{colspan:3}},[t._v(t._s(a.kmmc))]),e("td",[t._v(t._s(a["平时成绩"]))]),e("td",[t._v(t._s(a["期中成绩"]))]),e("td",[t._v(t._s(a["平时成绩平均分"]))]),e("td",[t._v(t._s(a["期末成绩"]))]),e("td",[t._v(t._s(a["期末成绩平均分"]))]),e("td",[t._v(t._s(a["总评成绩"]))])])})),e("tr",[e("td",{attrs:{colspan:3}},[t._v("品德等第")]),e("td",{attrs:{colspan:6}},[t._v(" "+t._s(t.studentDoc.pddd)+" ")])]),e("tr",[e("td",{attrs:{colspan:9}},[e("div",[e("div",{staticStyle:{"text-align":"left","padding-left":"10px","padding-bottom":"6px"}},[t._v(" 班主任评语 ")]),null!==t.studentDoc.pingyu&&""!==t.studentDoc.pingyu?e("div",{staticStyle:{padding:"0 8px"}},t._l(t.studentDoc.pingyu,(function(a,n){return e("p",{key:"pingyu-".concat(n),staticClass:"duan",domProps:{textContent:t._s(a)}})})),0):e("div",{staticStyle:{height:"100px"}})])])])],2)]):e("table",{staticClass:"document-table"},[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"center"},attrs:{colspan:t.colspan}},[e("div",[t._v("上海市实验学校学生成绩汇报单")]),e("div",[t._v(t._s("".concat(t.studentDoc.termname||"---")))]),e("div",[t._v(t._s("".concat(t.studentDoc.classname||"---"," - ").concat(t.studentDoc.xm||"---")))])])])]),e("tbody",[t._l(t.studentDoc.subjectinfo,(function(a,n){return["核心课程"===a.kmmc||"学养课程"===a.kmmc?[e("tr",{key:n},[e("th",{attrs:{colspan:"2"===t.termflag?10:9}},[t._v(" "+t._s(a.kmmc)+" ")])]),e("tr",{key:"".concat(n,"key")},[e("th",[t._v("科目")]),e("th",[t._v("平时成绩")]),e("th",[t._v("期中成绩")]),t.needRank?e("th",[t._v("年级名次")]):t._e(),"dt"!==t.branch?e("th",[t._v("年级平均")]):t._e(),e("th",[t._v("期末成绩")]),t.needRank?e("th",[t._v("年级名次")]):t._e(),"dt"!==t.branch?e("th",[t._v("年级平均")]):t._e(),e("th",[t._v("学期总评")]),"2"===t.termflag?e("th",[t._v("学年总评")]):t._e()])]:t._e(),"2"!==a.kmlxid&&" "!==a.kmid?[e("tr",{key:"".concat(n,"tr")},[e("td",[t._v(t._s(a.kmmc))]),e("td",[t._v(t._s(a["平时成绩"]))]),e("td",[t._v(t._s(a["期中成绩"]))]),t.needRank?e("td",[t._v(t._s(a["期中成绩年级名次"]))]):t._e(),"dt"!==t.branch?e("td",[t._v(t._s(a["期中成绩平均分"]))]):t._e(),e("td",[t._v(t._s(a["期末成绩"]))]),t.needRank?e("td",[t._v(t._s(a["期末成绩年级名次"]))]):t._e(),"dt"!==t.branch?e("td",[t._v(t._s(a["期末成绩平均分"]))]):t._e(),e("td",[t._v(t._s(a["总评成绩"]))]),"2"===t.termflag?e("td",[t._v(t._s(a["学年总评成绩"]))]):t._e()])]:t._e(),"选课成绩"===a.kmmc?[e("tr",{key:n},[e("th",{attrs:{colspan:"8"}},[t._v(" "+t._s(a.kmmc)+" ")])]),e("tr",{key:"".concat(n,"key")},[e("th",[t._v("科目")]),e("th",{attrs:{colspan:"7"}},[t._v("成绩")])])]:t._e(),"2"===a.kmlxid?[e("tr",{key:"".concat(n,"tr")},[e("td",[t._v(t._s(a.kmmc))]),e("td",{attrs:{colspan:"7"}},[t._v(t._s(a.df))])])]:t._e()]})),e("tr",[e("td",[t._v("品德等第")]),e("td",{attrs:{colspan:"2"===t.termflag?9:8}},[t._v(" "+t._s(t.studentDoc.pddd)+" ")])]),e("tr",[e("td",{attrs:{colspan:"2"===t.termflag?10:9}},[e("div",[e("div",{staticStyle:{"text-align":"left","padding-left":"10px","padding-bottom":"6px"}},[t._v(" 班主任评语 ")]),null!==t.studentDoc.pingyu&&""!==t.studentDoc.pingyu?e("div",{staticStyle:{padding:"0 8px"}},t._l(t.studentDoc.pingyu,(function(a,n){return e("p",{key:"pingyu-".concat(n),staticClass:"duan",domProps:{textContent:t._s(a)}})})),0):e("div",{staticStyle:{height:"80px"}})])])])],2)]),e("img",{attrs:{src:a("f343"),alt:""}}),e("div",{staticClass:"py-box"},[e("span",{staticStyle:{"padding-right":"100px"}},[t._v("班主任签字")]),e("span",{staticClass:"gai-zhan",staticStyle:{"padding-right":"90px"}},[t._v(" 学校盖章 ")]),e("span",[e("span",{staticStyle:{"padding-right":"50px"}},[t._v("年")]),e("span",{staticStyle:{"padding-right":"50px"}},[t._v("月")]),e("span",[t._v("日")])])])])])}),f=[],v=function(t){Object(o["a"])(a,t);var e=Object(c["a"])(a);function a(){var t;return Object(i["a"])(this,a),t=e.apply(this,arguments),t.studentDoc={},t.tableHeaderData={},t.termflag="1",t.loading=!1,t.branch="",t.needAvgScore=!1,t.needGaosan=!1,t}return Object(d["a"])(a,[{key:"colspan",get:function(){return"2"===this.termflag?this.needRank?10:8:this.needRank?9:7}},{key:"hasData",value:function(t){var e=["物理","化学","思想政治","历史","地理","生物"];if(e.indexOf(t.kmmc)<0)return!0;var a=!1;return this.tableHeaderData.forEach((function(e){t[e.ksmc]&&(a=!0)})),a}},{key:"open",value:function(){var t=this;this.loading=!0,"高三"===this.studentInfo.njmc?(this.needGaosan=!0,this.$api.analysisApi.previewStudentDocThree({xqid:this.studentInfo.xqid,bjnjfpid:this.studentInfo.bjnjfpid,xsid:[this.studentInfo.xsid],xm:[this.studentInfo.xm],needRank:"1",needGrade:"1",needAvgScore:this.needAvgScore?"1":"0"}).then((function(e){e.status===t.$httpOk?(t.branch=e.branch,t.studentDoc=e.data[0],t.studentDoc.pingyu=t.studentDoc.pingyu.split("\n"),t.termflag=e.termflag,t.tableHeaderData=e.ksList):Object(u["i"])(e.message,e.status),t.loading=!1})).catch((function(){return t.loading=!1}))):(this.needGaosan=!1,this.$api.analysisApi.previewStudentDoc({xqid:this.studentInfo.xqid,bjnjfpid:this.studentInfo.bjnjfpid,xsid:[this.studentInfo.xsid],xm:[this.studentInfo.xm],needRank:this.needRank?"1":"0",needGrade:this.needGrade?"1":"0",needAvgScore:this.needAvgScore?"1":"0"}).then((function(e){e.status===t.$httpOk?(t.branch=e.branch,t.studentDoc=e.data[0],t.studentDoc.pingyu=t.studentDoc.pingyu.split("\n"),t.termflag=e.termflag):Object(u["i"])(e.message,e.status),t.loading=!1})).catch((function(){return t.loading=!1})))}},{key:"close",value:function(){this.$emit("close")}}]),a}(r["d"]);Object(l["a"])([Object(r["c"])({default:!1})],v.prototype,"visible",void 0),Object(l["a"])([Object(r["c"])({default:!1})],v.prototype,"needRank",void 0),Object(l["a"])([Object(r["c"])({default:!1})],v.prototype,"needGrade",void 0),Object(l["a"])([Object(r["c"])({default:{}})],v.prototype,"studentInfo",void 0),v=Object(l["a"])([r["a"]],v);var p=v,h=p,b=(a("86ba"),a("2877")),_=Object(b["a"])(h,m,f,!1,null,"cd7e8f28",null),j=_.exports,k=a("1652"),x=function(t){Object(o["a"])(a,t);var e=Object(c["a"])(a);function a(){var t;return Object(i["a"])(this,a),t=e.apply(this,arguments),t.form={xqid:"",njid:"",bjid:""},t.needRank=!1,t.needGrade=!1,t.xm="",t.xqList=[],t.njList=[],t.bjList=[],t.xsList=[],t.tableData=[],t.needGaosan=!1,t.selection=[],t.visible=!1,t.studentInfo={},t}return Object(d["a"])(a,[{key:"watchForm",value:function(){var t=this;""!==this.form.xqid&&""!==this.form.njid&&""!==this.form.bjid&&this.search(),""!==this.form.xm&&(this.tableData=this.xsList.filter((function(e){return-1!==e.xm.indexOf(t.form.xm)})))}},{key:"created",value:function(){var t=this;this.$load.start(),this.$api.commonApi.getDict(k["a"].allTerm).then((function(e){t.xqList=Object(u["f"])(e,"termname","xqid",!1),t.form.xqid=Object(u["g"])(t.xqList),t.$api.analysisApi.getNjList(t.form.xqid).then((function(e){t.njList=Object(u["f"])(e.data,"njmc","njid",!1),t.njList.length>0?(t.form.njid=t.njList[0].value,t.form.bjid="",t.$api.analysisApi.getClassesByNj(t.form.xqid,t.form.njid).then((function(e){t.bjList=Object(u["f"])(e.data,"classname","bjnjfpid",!1),Object(u["j"])(t.bjList,"classcode"),t.bjList.length>0?t.form.bjid=t.bjList[0].value:t.form.bjid="",t.$load.end()})).catch((function(){return t.$load.end()}))):t.form.njid=""})).catch((function(){return t.$load.end()}))}))}},{key:"reset",value:function(){this.form.xqid=Object(u["g"])(this.xqList),this.xqChange(this.form.xqid)}},{key:"search",value:function(){var t=this;""!==this.form.bjid&&""!==this.form.njid&&""!==this.form.xqid?this.$api.commonApi.getClassStudentByBjNjFpId(this.form.bjid).then((function(e){t.xm="",t.xsList=e.data,t.tableData=Object(u["c"])(t.xsList)})):Object(u["i"])("请选择学期、年级、班级后查询","info")}},{key:"xmInput",value:function(t){this.tableData=this.xsList.filter((function(e){return-1!==e.xm.indexOf(t)}))}},{key:"tableSelect",value:function(t){this.selection=t}},{key:"downAllDoc",value:function(t){var e=this;this.$load.start();var a=[],n=[];this.selection.length>0?this.selection.forEach((function(t){a.push(t.xsid),n.push(t.xm)})):this.xsList.forEach((function(t){a.push(t.xsid),n.push(t.xm)})),this.$api.analysisApi.getDownStudentDocUrl({xqid:this.form.xqid,bjnjfpid:this.xsList[0].bjnjfpid,xsid:a,xm:n,needRank:this.needRank?"1":"0",needGrade:this.needGrade?"1":"0",needZipFile:t}).then((function(t){var a=t.status,n=t.data,s=t.message,i=t.filename;a===e.$httpOk?e.$api.analysisApi.downStudentDoc(n,i).then((function(){e.$load.end()})):(Object(u["i"])(s,a),e.$load.end())})).catch((function(){e.$load.end()}))}},{key:"downDoc",value:function(t){var e=this;this.$load.start();var a={xqid:this.form.xqid,bjnjfpid:t.bjnjfpid,xsid:[t.xsid],xm:[t.xm],needRank:this.needRank?"1":"0",needGrade:this.needGrade?"1":"0",needZipFile:"0"};this.$api.analysisApi.getDownStudentDocUrl(a).then((function(t){var a=t.status,n=t.data,s=t.message,i=t.filename;a===e.$httpOk?e.$api.analysisApi.downStudentDoc(n,i):Object(u["i"])(s,a),e.$load.end()})).catch((function(){e.$load.end()}))}},{key:"preview",value:function(t){this.studentInfo=t,this.visible=!0}},{key:"xqChange",value:function(t){var e=this;this.$api.analysisApi.getNjList(t).then((function(t){e.njList=Object(u["f"])(t.data,"njmc","njid",!1),e.njList.length>0?(e.form.njid=e.njList[0].value,e.njChange(e.form.njid)):e.form.njid=""}))}},{key:"njChange",value:function(t){var e=this;this.needGaosan=!1,"16"===t?(this.needGaosan=!0,this.needRank=!0):(this.needGaosan=!1,this.needRank=!1),this.form.bjid="",this.$api.analysisApi.getClassesByNj(this.form.xqid,t).then((function(t){e.bjList=Object(u["f"])(t.data,"classname","bjnjfpid",!1),Object(u["j"])(e.bjList,"classcode"),e.bjList.length>0?e.form.bjid=e.bjList[0].value:e.form.bjid=""}))}}]),a}(r["d"]);Object(l["a"])([Object(r["e"])("form",{deep:!0})],x.prototype,"watchForm",null),x=Object(l["a"])([Object(r["a"])({components:{StudentDocPreview:j}})],x);var g=x,y=g,D=Object(b["a"])(y,n,s,!1,null,"151e02e7",null);e["default"]=D.exports},7180:function(t,e,a){},"86ba":function(t,e,a){"use strict";a("7180")},f343:function(t,e,a){t.exports=a.p+"img/zhan.072aa0c3.png"}}]);